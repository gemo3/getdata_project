setwd("C://COURSERA/getdata/project")
con1<-file("X_test.txt")
con2<-file("X_train.txt")
con3<-file("y_test.txt")
con4<-file("y_train.txt")
con5<-file("subject_test.txt")
con6<-file("subject_train.txt")
con7<-file("features.txt")
con8<-file("activity_labels.txt")
open(con1,"r")
open(con2,"r")
open(con3,"r")
open(con4,"r")
open(con5,"r")
open(con6,"r")
open(con7,"r")
open(con8,"r")
test<-read.csv(con1,sep="")
train<-read.csv(con2,sep="")
atest<-read.csv(con3,sep="")
atrain<-read.csv(con4,sep="")
stest<-read.csv(con5,sep="")
strain<-read.csv(con6,sep="")
features<-read.csv(con7,header=FALSE,sep="")
activities<-read.csv(con8,header=FALSE,sep="")
close(con1)
close(con2)
close(con3)
close(con4)
close(con5)
close(con6)
close(con7)
close(con8)
library(dplyr)
strain<-mutate(strain,n=seq(1:7351))
atrain<-mutate(atrain,n=seq(1:7351))
train<-mutate(train,n=seq(1:7351))
satrain<-merge(strain,atrain,by.x="n",by.y="n",all=TRUE)
mergedtrain<-merge(satrain,train,by.x="n",by.y="n",all=TRUE)
mergedtrain<-select(mergedtrain,-n)
stest<-mutate(stest,n=seq(1:2946))
atest<-mutate(atest,n=seq(1:2946))
test<-mutate(test,n=seq(1:2946))
satest<-merge(stest,atest,by.x="n",by.y="n",all=TRUE)
mergedtest<-merge(satest,test,by.x="n",by.y="n",all=TRUE)
mergedtest<-select(mergedtest,-n)
names(mergedtrain)<-c("subject","act",as.character(features[,2]))
names(mergedtest)<-c("subject","act",as.character(features[,2]))
mergeddata<-rbind(mergedtrain,mergedtest)
mergeddata<-mergeddata[,unique(names(mergeddata))]
mergeddata<-select(mergeddata,subject,act,contains("mean()",ignore.case=TRUE),contains("std()",ignore.case=TRUE))
names(mergeddata)<-gsub("-","_",names(mergeddata))
names(mergeddata)<-gsub("\\(\\)","",names(mergeddata))
mergeddata<-mutate(mergeddata,activity=factor(1*act,labels=as.character(activities[,2])))
data<-select(mergeddata,subject,activity,3:68)
data<-group_by(data,subject,activity)
dataset<-summarise_each(data,funs(mean))
dataset<-as.data.frame(dataset)
names(dataset)<-gsub("BodyBody","Body",names(dataset))

